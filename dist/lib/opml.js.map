{"version":3,"sources":["../../src/lib/opml.js"],"names":[],"mappings":";;AAAA,IAAM,MAAM,QAAQ,KAAR,CAAZ;AACA,IAAM,KAAK,QAAQ,IAAR,CAAX;AACA,IAAM,KAAK,QAAQ,IAAR,CAAX;AACA,IAAM,IAAI,GAAG,UAAb;;AAEA,OAAO,OAAP,GAAiB;AACf,QADe,mBACP,IADO,EACD;AACZ,WAAO;AAAA,UAAG,UAAH,QAAG,UAAH;AAAA,aACL,EAAE,MAAF,CAAS,aAAK;AACZ,YAAM,YAAY,IAAI,YAAJ,EAAlB;AACA,YAAM,QAAQ,EAAd;AACA,WAAG,gBAAH,CAAoB,IAApB,EACG,IADH,CACQ,SADR;AAEA,kBAAU,EAAV,CAAa,SAAb,EAAwB,aAAK;AAC3B,cAAI,EAAE,IAAF,KAAW,SAAf,EAA0B;AAC1B,gBAAM,IAAN,CAAW,WAAW,EAAE,UAAF,CAAa,MAAb,IAAuB,EAAE,UAAF,CAAa,GAA/C,EAAoD,EAApD,CAAX;AACD,SAHD;AAIA,kBAAU,EAAV,CAAa,KAAb,EAAoB;AAAA,iBAClB,EAAE,QAAF,CAAW,KAAX,EACG,SADH,CAEI;AAAA,mBAAK,EAAE,MAAF,CAAS,CAAT,CAAL;AAAA,WAFJ,EAGI;AAAA,mBAAO,EAAE,OAAF,CAAU,GAAV,CAAP;AAAA,WAHJ,EAII;AAAA,mBAAM,EAAE,WAAF,EAAN;AAAA,WAJJ,CADkB;AAAA,SAApB;AAQA,kBAAU,EAAV,CAAa,OAAb,EAAsB;AAAA,iBAAO,EAAE,OAAF,CAAU,GAAV,CAAP;AAAA,SAAtB;AACD,OAlBD,CADK;AAAA,KAAP;AAoBD;AAtBc,CAAjB","file":"opml.js","sourcesContent":["const sax = require('sax')\nconst fs = require('fs')\nconst Rx = require('rx')\nconst O = Rx.Observable\n\nmodule.exports = {\n  import (file) {\n    return ({ insertFeed }) =>\n      O.create(o => {\n        const saxStream = sax.createStream()\n        const tasks = []\n        fs.createReadStream(file)\n          .pipe(saxStream)\n        saxStream.on('opentag', t => {\n          if (t.name !== 'OUTLINE') return\n          tasks.push(insertFeed(t.attributes.XMLURL || t.attributes.URL, []))\n        })\n        saxStream.on('end', () =>\n          O.forkJoin(tasks)\n            .subscribe(\n              v => o.onNext(v),\n              err => o.onError(err),\n              () => o.onCompleted()\n            )\n        )\n        saxStream.on('error', err => o.onError(err))\n      })\n  }\n}\n\n"]}